---
layout: post
title: "리엑트 정리하기- 03번째 시간: DOM과 최적화, 그리고 삽질"
---

# 이번엔 DOM 관련해서 내가 겪은 안타까운 사례를 말해보고자함

## 상황 설명

팝업 형식의 메뉴를 만들려고했음.  

버튼을 누르면 페이지 오른쪽에 **`position: fixed`** 된 모달을 불러오는 거였는데  
**문제가 발생했음.**

에니메이션 효과가 적용이 안된 거였음.  

유추하기로 **DOM이 렌더링 되는 것보다 컴포넌트가 빨리 렌더링 되어버려서,  
에니메이션 효과가 끝난 채로 보여지는 상황**인 듯 했음.  

뭐 충분히 있을 수 있는 현상이니까,  
DOM 렌더링 후 `useState`를 써서 돔이 렌더링 된 걸 확인하고  
`setTimeout`으로 시간 지연을 부여했음.  

이렇게 하면 **컴포넌트 렌더링을 DOM 렌더링 이후로 맞출 수 있어서  
애니메이션이 잘 보일 거라 생각했음.**

---

## 두 번째 문제 발생

수정 후 다시 확인해 봤는데 새로운 문제가 생김.  

1. 메뉴를 열 때 **애니메이션이 버벅거림**  
2. 메뉴를 닫을 때 **애니메이션이 적용되지 않음**

이에 대해 왜 그런지 모르겠어서 GPT한테 해결방법을 물어봄.

---

# 대 재 앙 시작

GPT가 두 가지 방법을 제시했음 ~<< 씝쎄~

### 1. DOM이 완전히 사라지는 방법 (언마운트)

- **장점**  
  - 불필요한 노드가 DOM 트리에 남지 않음 → 렌더링/리플로우 비용 ↓  
  - 이벤트 리스너, ref, 상태 등도 다 같이 해제 → 메모리 누수 방지  
  - 모바일 같은 리소스 한정 환경에서는 더 안전  

- **단점**  
  - 다시 열 때마다 DOM을 새로 렌더링해야 함 → 컴포넌트 생성/렌더링 비용 ↑  
  - Transition 애니메이션 구현하려면 `isMounted + animate` 두 단계 상태 관리 필요 → 코드 복잡도 ↑  

---

### 2. DOM을 계속 유지하는 방법 (`display: none` / `translateX` 방식)

- **장점**  
  - 다시 열 때 DOM 재생성이 없음 → 더 빠름  
  - 상태를 유지할 수 있음 (예: 입력 폼 내용 그대로 남음)  
  - CSS transition만으로 열림/닫힘 애니메이션 구현이 쉬움  

- **단점**  
  - DOM이 계속 남아있음 → 렌더링 트리/메모리에 부담  
  - 숨겨져 있어도 이벤트 버블링/탭 순서 관리 필요  

---

## 내가 선택한 방법

나는 당연히 **1번을 선택**했지.  

왜냐면 리엑트 공부할 때 **자원을 아끼려면 DOM을 언마운트하는 게 좋다**고 배웠었거든.  

외주 작업하는데 그래도 완성도 높이고 싶다는 생각에,  
**“최적화 바로 하면 되는 거 아니야?”** 따위의 시건방진 생각을 했음.  

그렇게 장장 4시간의 코딩지옥에 빠져버림.

---

# 대 실 패

어떻게 해도 애니메이션이 의도한 대로 이쁘게 동작하지 않았음.  
멘탈이 나가버렸고, 결국 코딩 잘하는 형한테 물어봄.  

해결 방법은 **의외로 단순했음.**  

**2번으로 하면 됐던 거... 하;;**  

그냥 굳이 DOM을 언마운트하지 말고, 화면상에서 안 보이게 처리해놓으면 됐던 거.  

---

난 몰랐지 이렇게 해도 되는 줄.  
GPT가 겁줬잖아 **“메모리 부담”** 이라는 무시무시한 표현을 쓰면서 말이야.  

사실 내가 이런 걸 제대로 만들어본 경험이 있었다면  
최적화에 대한 감도 있었을 테고,  
메뉴 팝업 같은 간단한 정도로는 부담이 전혀 없다는 판단도 했을 텐데…  

처음이라 **삽질 뒤지게 함.**  

사실 GPT가 못난 게 아니라 내가 멍청해버린 거 앎.  
하지만 아무튼간에 GPT 책임도 있음.  
*난 유료 사용자니까 ㅇㅇ  
반박 안받음 ㅇㅇ*

---

## 교훈

이번 **대 재 앙**을 겪으면서 얻은 교훈은 이거임.  

- **초행길을 걸을 때에는 힘을 빼고, 빠른 완성을 목표로 두자.**  
- **완성되지 않은 상태에서 최적화를 하려는 건 나쁜 습관이다.**  

추가로 도와준 형이 이런 말을 했음.  

> 지금이 1970년대도 아니고… 그 정도 자원은 낭비해도 잘 돌아가,,

---

## 정리

**1. 완성 먼저**  
**2. 코드는 간단하게**  
**3. 최적화 가능할 거 같은데? → 일단 참아**

# 끝
